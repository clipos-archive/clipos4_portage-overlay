# Clip ChangeLog for <sys-apps/shadow>

*shadow-4.1.5.1-r5 (26 Feb 2016)

  26 Feb 2016; ANSSI <clipos@ssi.gouv.fr>
  +shadow-4.1.5.1-r5.ebuild, -shadow-4.1.5.1-r4.ebuild:
  Fix strong bug with pam_jail login process flow.

*shadow-4.1.5.1-r4 (25 Feb 2016)

  25 Feb 2016; Timothée Ravier <clipos@ssi.gouv.fr>
  +shadow-4.1.5.1-r4.ebuild, -shadow-4.1.5.1-r3.ebuild:
  RBump to fix conflict with pambase in SDKs (/etc/pam.d/login).

  19 Feb 2016; ANSSI <clipos@ssi.gouv.fr>
  shadow-4.1.5.1-r3.ebuild, files/pam.d.clip/login:
  Migrate from clip-tiny to clip-bare.

  25 Jan 2016; Yves-Alexis Perez <clipos@ssi.gouv.fr>
  files/shadow-4.1.5.1-makefile-ldflags-and-bad-directive.patch:
  Don't rename LDADD to LDFLAGS, just add relevant linked libs where needed.

*shadow-4.1.5.1-r3 (22 Jun 2015)

  22 Jun 2015; Yves-Alexis Perez <clipos@ssi.gouv.fr>
  +shadow-4.1.5.1-r3.ebuild, -shadow-4.1.5.1-r2.ebuild, files/login.defs.tcb:
  Explicitely set SYS_GID_{MIN,MAX}.

*shadow-4.1.5.1-r2 (13 Mar 2015)

  13 Mar 2015; ANSSI <clipos@ssi.gouv.fr>
  +shadow-4.1.5.1-r2.ebuild, -shadow-4.1.2.2-r10.ebuild,
  -files/4.1.2.2
  -files/4.1.2.2/shadow-svn-2298.patch
  -files/4.1.2.2/shadow-svn-2364.patch
  -files/login.defs
  -files/login.pamd
  -files/login.pamd.1
  -files/login.pamd.2
  -files/login_defs.awk
  -files/login_defs_pam.sed
  -files/pam.d
  -files/pam.d/login
  -files/pam.d/other
  -files/pam.d/passwd
  -files/pam.d/shadow
  -files/pam.d/su
  -files/pam.d/system-auth
  -files/pam.d/system-auth-1.1
  -files/shadow-4.0.13-dots-in-usernames.patch
  -files/shadow-4.0.13-long-groupnames.patch
  -files/shadow-4.0.17-login.defs.patch
  -files/shadow-4.1.2.1+openpam.patch
  -files/shadow-4.1.2.2-aclocal.patch
  -files/shadow-4.1.2.2-avx-owl-crypt_gensalt.patch
  -files/shadow-4.1.2.2-avx-owl-tcb.patch
  -files/shadow-4.1.2.2-avx-owl-usergroupname_max.patch
  -files/shadow-4.1.2.2-clip-nofollow.patch
  -files/shadow-4.1.2.2-clip-pam_jail-login.patch
  +files/shadow-4.1.3-dots-in-usernames.patch
  +files/shadow-4.1.5.1-avx-owl-crypt_gensalt.patch
  +files/shadow-4.1.5.1-avx-owl-tcb.patch
  +files/shadow-4.1.5.1-avx-owl-usergroupname_max.patch
  +files/shadow-4.1.5.1-clip-nofollow.patch
  +files/shadow-4.1.5.1-makefile-ldflags-and-bad-directive.patch
  +files/shadow-4.1.5.1-pam_jail-login.patch
  +files/shadow-4.1.5.1-stdbool.patch:
  Bump shadow.
  Recreated tcb related patches as shadow now partially
  includes the tcb feature.

*shadow-4.1.2.2-r10 (08 Apr 2014)

  08 Apr 2014; ANSSI <clipos@ssi.gouv.fr>
  +shadow-4.1.2.2-r10.ebuild, -shadow-4.1.2.2-r9.ebuild:
  Add a FAKE_SHELL on clip-tiny for console login.
  Add missing capabilities to /bin/login.

*shadow-4.1.2.2-r9 (07 Apr 2014)

  07 Apr 2014; ANSSI <clipos@ssi.gouv.fr>
  +shadow-4.1.2.2-r9.ebuild, -shadow-4.1.2.2-r7.ebuild,
  files/pam.d.clip/login:
  Add pam_exec_pwd for clip-tiny.

*shadow-4.1.2.2-r8 (20 Mar 2014)

  20 Mar 2014; ANSSI <clipos@ssi.gouv.fr>
  +shadow-4.1.2.2-r8.ebuild, -shadow-4.1.2.2-r7.ebuild,
  +files/shadow-4.1.2.2-clip-pam_jail-login.patch:
  Add clip-tiny support with pam_jail.

  02 Sep 2013; Vincent Strubel <clipos@ssi.gouv.fr>
  shadow-4.1.2.2-r7.ebuild, +files/shadow-4.1.2.2-aclocal.patch,
  files/shadow-4.1.2.2-avx-owl-tcb.patch:
  Build fix.

*shadow-4.1.2.2-r7 (07 Mar 2013)

  07 Mar 2013; Mickaël Salaün <clipos@ssi.gouv.fr>
  +shadow-4.1.2.2-r7.ebuild, -shadow-4.1.2.2-r6.ebuild,
  files/pam.d.clip/system-auth:
  Set default umask to 0077.

*shadow-4.1.2.2-r6 (28 Jan 2013)

  28 Jan 2013; Yves-Alexis Perez <clipos@ssi.gouv.fr>
  +shadow-4.1.2.2-r6.ebuild, -shadow-4.1.2.2-r5.ebuild:
  Never install /etc/pam.d/{system-auth,others} (shipped by pam).

  24 Nov 2011; Mickaël Salaün <clipos@ssi.gouv.fr>
  shadow-4.1.2.2-r5.ebuild:
  Depend on sys-apps/tcb.

*shadow-4.1.2.2-r5 (02 Nov 2011)

  02 Nov 2011; Mickaël Salaün <clipos@ssi.gouv.fr>
  +shadow-4.1.2.2-r5.ebuild, -shadow-4.1.2.2-r4.ebuild:
  Replace pambase dependency by installing /etc/pam.d/* files for
  clip-devstation.

  25 Nov 2010; Vincent Strubel <clipos@ssi.gouv.fr>
  shadow-4.1.2.2-r4.ebuild:
  Remove dependency on pambase for clip-devstation as well.

*shadow-4.1.2.2-r4 (08 Nov 2010)
  08 Nov 2010; Benjamin Morin <clipos@ssi.gouv.fr>
  +shadow-4.1.2.2-r4.ebuild, -shadow-4.1.2.2-r3.ebuild:
  Modified slim & system-auth pam.d entries (added pam_wheel).

*shadow-4.1.2.2-r3 (04 Nov 2010)

  04 Nov 2010; Vincent Strubel <clipos@ssi.gouv.fr>
  +shadow-4.1.2.2-r3.ebuild, -shadow-4.1.2.2-r2.ebuild,
  files/login.defs.tcb:
  Change user / group names max length to 32 bytes.

*shadow-4.1.2.2-r2 (13 Jul 2010)
  12 Jul 2010; Benjamin Morin <clipos@ssi.gouv.fr>
  +shadow-4.1.2.2-r2.ebuild, -shadow-4.1.2.2-r1.ebuild:
  Modified slim & system-auth pam.d entries to support smartcard authentication. Added a dependency with sys-auth/pam_pkcs11

*shadow-4.1.2.2-r1 (21 Jul 2009)

  21 Jul 2009; Vincent Strubel <clipos@ssi.gouv.fr>
  +shadow-4.1.2.2-r1.ebuild, -shadow-4.1.2.2.ebuild:
  Add slim pam.d entry.

  10 Mar 2009; Vincent Strubel <clipos@ssi.gouv.fr>
  files/shadow-4.1.2.2-avx-owl-tcb.patch:
  Fix userdel: remove_tree() now tries do remove the root directory
  it gets passed as argument, which does not work when calling it 
  with reduced privs in TCB userdel.

*shadow-4.1.2.2 (03 Mar 2009)

  03 Mar 2009; Vincent Strubel <clipos@ssi.gouv.fr>
  +shadow-4.1.2.2.ebuild, -shadow-4.0.18.2-r4.ebuild:
  +files/4.1.2.2, +files/shadow-4.1.2.1+openpam.patch,
  -files/shadow-4.0.12-gcc2.patch, -files/shadow-4.0.15-uclibc-missing-l64a.patch,
  -files/shadow-4.0.11.1-perms.patch, -files/shadow-4.0.13-nonis.patch,
  -files/shadow-4.0.16-fix-useradd-usergroups.patch, -files/shadow-4.0.18.2-useradd.patch:
  -files/shadow-4.0.15-clip-nofollow.patch, -files/shadow-4.0.18-avx-owl-usergroupname_max.patch,
  -files/shadow-4.0.18-avx-owl-tcb.patch, -files/shadow-4.0.18-avx-owl-crypt_gensalt.patch,
  +files/shadow-4.1.2.2-avx-owl-usergroupname_max.patch, +files/shadow-4.1.2.2-clip-nofollow.patch,
  +files/shadow-4.1.2.2-avx-owl-tcb.patch, +files/shadow-4.1.2.2-avx-owl-crypt_gensalt.patch:
  Bump to latest stable, fix CVE-2008-5394.

*shadow-4.0.18.2-r4 (23 Oct 2008)

  23 Oct 2008; Vincent Strubel <clipos@ssi.gouv.fr>
  +shadow-4.0.18.2-r4.ebuild, -shadow-4.0.18.2-r3.ebuild,
  files/login.defs.tcb:
  Switch USERNAME_MAX to 16.

*shadow-4.0.18.2-r3 (25 Aug 2008)

  25 Aug 2008; Vincent Strubel <clipos@ssi.gouv.fr>
  +shadow-4.0.18.2-r3.ebuild, -shadow-4.0.18.2-r2.ebuild,
  files/pam.d.clip/shadow:
  Add a session module to the default 'shadow' pam configuration
  for CLIP.

*shadow-4.0.18.2-r2 (29 Jul 2008)

  29 Jul 2008; Vincent Strubel <clipos@ssi.gouv.fr>
  +shadow-4.0.18.2-r2.ebuild, -shadow-4.0.18.2-r1.ebuild,
  files/pam.d.clip/shadow, -files/pam.d.clip/su, 
  +files/pam.d.clip/login, -files/pam.d.clip/xserver,
  +files/securetty.clip:
  Miscellaneous fixes for pam files:
   - remove useless stacks : newgroups, xserver, etc
   - provide a generic shadow stack fitted to CLIP (pam_rootok + pam_deny)
   - simplify the login stack
   - add a securetty file for CLIP

*shadow-4.0.18.2-r1 (19 Jun 2008)

  19 Jun 2008; Vincent Strubel <clipos@ssi.gouv.fr>
  +shadow-4.0.18.2-r1.ebuild, -shadow-4.0.18.2.ebuild,
  +files/default/useradd.clip:
  Add a CLIP useradd default file, with a proper default GID.

*shadow-4.0.18.2 (19 May 2008)

  19 May 2008; Vincent Strubel <clipos@ssi.gouv.fr>
  +shadow-4.0.18.2.ebuild, -shadow-4.0.18.1-r3.ebuild,
  -files/shadow-4.0.18.1-owl_tcb.patch,
  -files/shadow-4.0.18.1-owl_blowfish.patch,
  -files/shadow-4.0.18.1-useradd-usermod.patch,
  -files/shadow-po-mkinstalldir.patch,
  +files/shadow-4.0.18-avx-owl-crypt_gensalt.patch,
  +files/shadow-4.0.18-avx-owl-usergroupname_max.patch,
  +files/shadow-4.0.18-avx-owl-tcb.patch,
  files/login.defs.tcb:
  Bump to latest stable shadow, regenerate tcb patches from annvix versions,
  add annvix usegroupname_max patch, add matching defines in login.defs, 
  remove po-mkinstalldir patch (no longer needed).

*shadow-4.0.18.1-r3 (18 Mar 2008)
 
  18 Mar 2008; Vincent Strubel <clipos@ssi.gouv.fr>
  -shadow-4.0.18.1-r2.ebuild, +shadow-4.0.18.1-r3.ebuild,
  files/login.defs.tcb:
  Add bcrypt prefix and rounds count definitions.

*shadow-4.0.18.1-r2 (12 Dec 2007)
 
  12 Dec 2007; Olivier Levillain <clipos@ssi.gouv.fr>
  -shadow-4.0.18.1-r1.ebuild, +shadow-4.0.18.1-r2.ebuild
  Add a dependency when clip-tcb is used (pam_userpass)

*shadow-4.0.18.1-r1 (28 Nov 2007)
 
  28 Nov 2007; Vincent Strubel <clipos@ssi.gouv.fr>
  +shadow-4.0.18.1-r1.ebuild, files/login.defs.tcb
  -shadow-4.0.15-r5.ebuild,
  -files/shadow-4.0.14-su-fix-environment.patch,
  -files/shadow-4.0.15-no-default-MAIL.patch,
  -files/shadow-4.0.15-owl_blowfish.patch,
  -files/shadow-4.0.15-sanity-checks.patch,
  -files/shadow-4.0.13-login.defs.patch,
  +files/shadow-po-mkinstalldir.patch,
  +files/shadow-4.0.16-fix-useradd-usergroups.patch,
  +files/shadow-4.0.17-login.defs.patch,
  +files/shadow-4.0.18.2-useradd.patch,
  +files/shadow-4.0.18.1-owl_tcb.patch,
  +files/shadow-4.0.18.1-owl_blowfish.patch,
  +files/digest-shadow-4.0.18.1-r1,
  +files/shadow-4.0.18.1-useradd-usermod.patch:
  Bump to latest Gentoo stable. Patches are unchanged except some
  fuzz removal. Removed obsolete var from login.defs. Added patch
  to fix po/Makefile.in.in with recent versions of gettext (bug #102).
  
*shadow-4.0.15-r5 (28 Nov 2007)
 
  28 Nov 2007; Vincent Strubel <clipos@ssi.gouv.fr>
  +shadow-4.0.15-r5.ebuild, files/pam.d.clip/xdm,
  -shadow-4.0.15-r4.ebuild:
  Add 'close_run_all' option to pam_exec_pwd in xdm pam config.

  07 Nov 2007; Vincent Strubel <clipos@ssi.gouv.fr>
  Remove stale ebuilds before 4.0.15-r4.

*shadow-4.0.15-r4 (30 Oct 2007)
 
  30 Oct 2007; Vincent Strubel <clipos@ssi.gouv.fr>
  +shadow-4.0.15-r4.ebuild, files/pam.d.clip/xdm:
  Switch to pam_exec_pwd instead of pam_mount for xdm.
  
*shadow-4.0.15-r3 (08 Jun 2007)
 
  08 Jun 2007; Vincent Strubel <clipos@ssi.gouv.fr>
  +shadow-4.0.15-r3.ebuild, +files/shadow-4.0.15-clip-nofollow.patch:
  At long last, open files without the NOFOLLOW option, so that our
  etc/core symlinks survive a useradd. Note that the added vulnerability
  should be compensated by the fact that pretty much everything that
  shadow manipulates is RO in clip.
  
  08 Jun 2007; Vincent Strubel <clipos@ssi.gouv.fr>
  +files/pam.d.clip/passwd, shadow-4.0.15-r2.ebuild:
  Fix pam.d/passwd not being installed. TODO: we should provide 
  some way to update passwords in that case.
  
  26 Feb 2007; Vincent Strubel <clipos@ssi.gouv.fr>
  +files/pam.d.clip/shadow, +files/pam.d.clip/su,
  shadow-4.0.15-r2.ebuild:
  Rationalize and clean-up pam.d files. Set proper perms on s{ug}id 
  binaries with tcb.

  12 Oct 2006; Vincent Strubel <clipos@ssi.gouv.fr>
  +files/shadow-4.0.15-owl_blowfish.patch,
  +files/shadow-4.0.15-owl_tcb.patch,
  +files/login.defs.tcb,
  files/pam.d.clip/system-auth,
  shadow-4.0.15-r2.ebuild:
  Add support for OpenWall's crypt_blowfish and shadow_tcb. 
  
  Patches based on:
   - blowfish patch for 4.0.17 from HLFS (http://www.topside.org/~ashes/new),
   backported to 4.0.15
   - tcb patch for 4.0.12 from Annvix (itself based on OpenWall's patch
   for 4.0.4-r1), forward ported to 4.0.15

   TODO: now remove the suid bits....

  13 Sep 2006; Vincent Strubel <clipos@ssi.gouv.fr>
  +files/pam.d.clip/xdm, +files/pam.d.clip/xserver:
  Move file originally from x11-apps/xdm to shadow. See xdm's 
  ChangeLog. Same goes for xserver, originally from x11-apps/xinit.

*shadow-4.0.15-r2 (25 Aug 2006)
 
  25 Aug 2006; Vincent Strubel <clipos@ssi.gouv.fr>
  shadow-4.0.15-r2.ebuild, +files/pam.d.clip/*:
  Add pam_mount compliant pam.d files.
